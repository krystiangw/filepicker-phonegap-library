var filepicker=(function(){return{setKey:b,pick:d,pickAndStore:i};function i(m,n,p,o){e();var j=!!(m.multiple);var l=!!m?h(m):{};l.storeLocation=n.location||"S3";l.storePath=n.path;l.storeContainer=n.container;l.storeAccess=n.access||"private";if(j&&l.storePath){if(l.storePath.charAt(l.storePath.length-1)!="/"){throw"pickAndStore with multiple files requires a path that ends in '/'"}}var k=g(l,j);f(l);a(k,p,o)}function d(k,m,l){e();k=k||{};f(k);var j=g(k,null);a(j,m,l)}function b(j){window.filepicker.apikey=j}function c(){var j=new Date();return j.getTime().toString()}function e(){if(!window.filepicker.apikey){throw"Filepicker API Key not found"}}function h(k){var j={};for(key in k){j[key]=k[key]}return j}function g(l,j){var k="https://www.filepicker.io/dialog/open/";return k+"?key="+window.filepicker.apikey+"&id="+c()+"&iframe="+false+"&version=v1"+(l.services?"&s="+l.services.join(","):"")+(l.container!==undefined?"&container="+l.container:"modal")+(j?"&multi="+!!j:"")+(l.mimetypes!==undefined?"&m="+l.mimetypes.join(","):"")+(l.extensions!==undefined?"&ext="+l.extensions.join(","):"")+(l.openTo!==undefined?"&loc="+l.openTo:"")+(l.language?"&language="+l.language:"")+(l.maxSize?"&maxSize="+l.maxSize:"")+(l.maxFiles?"&maxFiles="+l.maxFiles:"")+(l.signature?"&signature="+l.signature:"")+(l.policy?"&policy="+l.policy:"")+(l.mobile!==undefined?"&mobile="+l.mobile:"")+(l.folders!==undefined?"&folders="+l.folders:"")+(l.storeLocation?"&storeLocation="+l.storeLocation:"")+(l.storePath?"&storePath="+l.storePath:"")+(l.storeContainer?"&storeContainer="+l.storeContainer:"")+(l.storeAccess?"&storeAccess="+l.storeAccess:"")+"&redirect_url=https://www.filepicker.io/dialog/phonegap_done/"}function a(j,n,m){var k=window.open(encodeURI(j),"_blank","location=no,fullscreen=no,toolbar=yes,titlebar=yes,scrollbars=yes,resizable=yes");var l=function(p){if(p.url.toString().indexOf("fpurl")>-1){var o=p.url.toString().split("fpurl=")[1];if(o.indexOf("&id=")>-1){o=o.split("&id=")[0]}o+="/metadata";$.get(o,function(q){q.url=j;k.close();n(q)}).error(function(){k.close();m()})}};if(k){if(k.addEventListener){k.addEventListener("loadstop",l)}else{k.attachEvent("loadstop",l)}}}function f(m){var l=function(r,q,s){if(m[q]){if(!k(m[q])){m[q]=[m[q]]}}else{if(m[r]){m[q]=[m[r]]}else{if(s){m[q]=s}}}};function p(s,q,r){if(s[q]===undefined){s[q]=r}}function k(q){return q&&Object.prototype.toString.call(q)==="[object Array]"}var o={COMPUTER:1,DROPBOX:2,FACEBOOK:3,GITHUB:4,GMAIL:5,IMAGE_SEARCH:6,URL:7,WEBCAM:8,GOOGLE_DRIVE:9,SEND_EMAIL:10,INSTAGRAM:11,FLICKR:12,VIDEO:13,EVERNOTE:14,PICASA:15,WEBDAV:16,FTP:17,ALFRESCO:18,BOX:19,SKYDRIVE:20,GDRIVE:21,CUSTOMSOURCE:22,CLOUDDRIVE:23};l("service","services");l("mimetype","mimetypes");l("extension","extensions");if(m.services){for(var n=0;n<m.services.length;n++){var j=(""+m.services[n]).replace(" ","");if(o[j]!==undefined){j=o[j]}m.services[n]=j}}if(m.mimetypes&&m.extensions){throw"Error: Cannot pass in both mimetype and extension parameters to the pick function"}if(!m.mimetypes&&!m.extensions){m.mimetypes=["*/*"]}if(m.openTo){m.openTo=o[m.openTo]||m.openTo}p(m,"container","window")}}());